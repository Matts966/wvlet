package cdp

import td_sdk_log

model weblogs: td_sdk_log =
  from 'weblogs/*.parquet'
end

--@config(watermark_column:time, window_size:'1h')
model behavior_weblogs =
  from weblogs
  where
    time is not null
    and td_client_id is not null
    and l.td_user_agent.category is not 'crawler'
    and td_client_id is not '00000000-0000-4000-8000-000000000000'
    and (
      td_browser is not null
      or not td_browser.regexp_like('^(?:Googlebot(?:-.*)?|BingPreview|bingbot|YandexBot|PingdomBot)$')
    )
    and td_host is not 'gtm-msr.appspot.com'
end
